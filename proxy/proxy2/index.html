<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Create a proxy server with Pfsense and Squid(Part 2) | WIMART Thomas</title><meta name=keywords content><meta name=description content="The different parts of this tutorial:
Part-1 Part-2 Part-3 Part-4 Part-5 Pfsense installation Click on &ldquo;Accept&rdquo;.
Select &ldquo;Install&rdquo;, then &ldquo;OK&rdquo;
The wizard will then ask you to select the layout of your keyboard (I have a French keyboard). Select the layout that suits you, then press &ldquo;Select&rdquo;.
Confirm your choice.
We are then asked how to partition our disk. Choose &ldquo;Auto (UFS) BIOS&rdquo;, then &ldquo;OK&rdquo;.
Pfsense will then start its installation:"><meta name=author content="Thomas"><link rel=canonical href=https://www.thomaswimart.fr/proxy/proxy2/><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.thomaswimart.fr/favicon.ico/><link rel=icon type=image/png sizes=16x16 href=https://www.thomaswimart.fr/favicon-16x16.png/><link rel=icon type=image/png sizes=32x32 href=https://www.thomaswimart.fr/favicon-32x32.png/><link rel=apple-touch-icon href=https://www.thomaswimart.fr/apple-touch-icon.png/><link rel=mask-icon href=https://www.thomaswimart.fr/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://www.thomaswimart.fr/proxy/proxy2/><link rel=alternate hreflang=fr href=https://www.thomaswimart.fr/fr/proxy/proxy2/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Create a proxy server with Pfsense and Squid(Part 2)"><meta property="og:description" content="The different parts of this tutorial:
Part-1 Part-2 Part-3 Part-4 Part-5 Pfsense installation Click on &ldquo;Accept&rdquo;.
Select &ldquo;Install&rdquo;, then &ldquo;OK&rdquo;
The wizard will then ask you to select the layout of your keyboard (I have a French keyboard). Select the layout that suits you, then press &ldquo;Select&rdquo;.
Confirm your choice.
We are then asked how to partition our disk. Choose &ldquo;Auto (UFS) BIOS&rdquo;, then &ldquo;OK&rdquo;.
Pfsense will then start its installation:"><meta property="og:type" content="article"><meta property="og:url" content="https://www.thomaswimart.fr/proxy/proxy2/"><meta property="article:section" content="proxy"><meta property="article:published_time" content="2022-12-06T10:55:47+01:00"><meta property="article:modified_time" content="2022-12-06T10:55:47+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Create a proxy server with Pfsense and Squid(Part 2)"><meta name=twitter:description content="The different parts of this tutorial:
Part-1 Part-2 Part-3 Part-4 Part-5 Pfsense installation Click on &ldquo;Accept&rdquo;.
Select &ldquo;Install&rdquo;, then &ldquo;OK&rdquo;
The wizard will then ask you to select the layout of your keyboard (I have a French keyboard). Select the layout that suits you, then press &ldquo;Select&rdquo;.
Confirm your choice.
We are then asked how to partition our disk. Choose &ldquo;Auto (UFS) BIOS&rdquo;, then &ldquo;OK&rdquo;.
Pfsense will then start its installation:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Proxies","item":"https://www.thomaswimart.fr/proxy/"},{"@type":"ListItem","position":2,"name":"Create a proxy server with Pfsense and Squid(Part 2)","item":"https://www.thomaswimart.fr/proxy/proxy2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Create a proxy server with Pfsense and Squid(Part 2)","name":"Create a proxy server with Pfsense and Squid(Part 2)","description":"The different parts of this tutorial:\nPart-1 Part-2 Part-3 Part-4 Part-5 Pfsense installation Click on \u0026ldquo;Accept\u0026rdquo;.\nSelect \u0026ldquo;Install\u0026rdquo;, then \u0026ldquo;OK\u0026rdquo;\nThe wizard will then ask you to select the layout of your keyboard (I have a French keyboard). Select the layout that suits you, then press \u0026ldquo;Select\u0026rdquo;.\nConfirm your choice.\nWe are then asked how to partition our disk. Choose \u0026ldquo;Auto (UFS) BIOS\u0026rdquo;, then \u0026ldquo;OK\u0026rdquo;.\nPfsense will then start its installation:","keywords":[],"articleBody":"The different parts of this tutorial:\nPart-1 Part-2 Part-3 Part-4 Part-5 Pfsense installation Click on “Accept”.\nSelect “Install”, then “OK”\nThe wizard will then ask you to select the layout of your keyboard (I have a French keyboard). Select the layout that suits you, then press “Select”.\nConfirm your choice.\nWe are then asked how to partition our disk. Choose “Auto (UFS) BIOS”, then “OK”.\nPfsense will then start its installation:\nIf the wizard asks you to open a Shell, answer “no.”\nYou will restart the virtual machine when the wizard suggests it.\nPfsense startup configuration On reboot, you will be asked if the VLANS should be configured. Press “n” then “Enter”.\nThen you have to tell Pfsense which interfaces correspond to the WAN and the LAN. For the moment, we don’t know what “em0” and “em1” correspond to, so let’s put them randomly (we can change this later).\nThen confirm by pressing “y”:\nAnd we have finally finished the installation of Pfsense! Now you should arrive on the main configuration menu.\nDon’t panic if you don’t have IP addresses for “em1” or “em0” (like me), we’ll fix that right away!\nPress the “1” key on the keyboard to assign the interfaces correctly.\nWe then notice that next to “em0” and “em1”, there are MAC addresses…\nThe wizard (re)asks us if we want to configure the VLANS. Press “n”.\nThen we are asked which interface corresponds to the WAN. But how do we know? “em0”? “em1”? A little explanation is necessary.\nWhen we configured the interfaces of the Pfsense VM, we put one in “LAN segment” and another in “Bridged”. The “LAN segment” one corresponds to the LAN side of Pfsense, while the “Bridged” one corresponds to the WAN side.\nBut how do you know which one corresponds to “em0” or “em1”? With the MAC addresses you normally wrote down earlier! In my case, I know that the LAN interface has a MAC address that ends with :d9:f4; and that the WAN interface’s MAC address ends with :6a:69.\nIt says right above which one corresponds to what.\nSo you can enter the interface that corresponds to the WAN side (in my case, “em0”):\nDo the same for the LAN interface:\nPress “y” to confirm the changes:\nPersonally, I will change the IP address of my LAN interface, so I will choose option 2:\nI will give it the IP address 192.168.100.254, with a mask of /24. (I also specify that I don’t want to use DHCP).\nIf you are offered to use HTTP for the WebConfigurator, press “y”.\nWe will then proceed to the configuration of PC1!\nThe next part of the tutorial is ➡️ here ⬅️.\n","wordCount":"447","inLanguage":"en","datePublished":"2022-12-06T10:55:47+01:00","dateModified":"2022-12-06T10:55:47+01:00","author":{"@type":"Person","name":"Thomas"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.thomaswimart.fr/proxy/proxy2/"},"publisher":{"@type":"Organization","name":"WIMART Thomas","logo":{"@type":"ImageObject","url":"https://www.thomaswimart.fr/favicon.ico/"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.thomaswimart.fr/ accesskey=h title="WIMART Thomas (Alt + H)"><img src=https://www.thomaswimart.fr/apple-touch-icon.png alt aria-label=logo height=30>WIMART Thomas</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://www.thomaswimart.fr/fr/ title=French aria-label="🌍 FR ">🌍 FR</a></li></ul></div></div><ul id=menu><li><a href=https://www.thomaswimart.fr/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://www.thomaswimart.fr/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://www.thomaswimart.fr/search/ title="Search 🔍 (Alt + /)" accesskey=/><span>Search 🔍</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Create a proxy server with Pfsense and Squid(Part 2)</h1><div class=post-meta><span title='2022-12-06 10:55:47 +0100 +0100'>December 6, 2022</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Thomas&nbsp;|&nbsp;Translations:<ul class=i18n_list><li><a href=https://www.thomaswimart.fr/fr/proxy/proxy2/>🌍 FR</a></li></ul></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#pfsense-installation aria-label="Pfsense installation">Pfsense installation</a></li><li><a href=#pfsense-startup-configuration aria-label="Pfsense startup configuration">Pfsense startup configuration</a></li></ul></div></details></div><div class=post-content><p>The different parts of this tutorial:</p><ul><li><a href=/posts/proxy>Part-1</a></li><li><a href=/proxy/proxy2>Part-2</a></li><li><a href=/proxy/proxy3>Part-3</a></li><li><a href=/proxy/proxy4>Part-4</a></li><li><a href=/proxy/proxy5>Part-5</a></li></ul><h2 id=pfsense-installation>Pfsense installation<a hidden class=anchor aria-hidden=true href=#pfsense-installation>#</a></h2><p><img loading=lazy src=/images/pfsense/pfsense1.png alt=pfsense1></p><p>Click on &ldquo;Accept&rdquo;.</p><p><img loading=lazy src=/images/pfsense/pfsense2.png alt=pfsense2></p><p>Select &ldquo;Install&rdquo;, then &ldquo;OK&rdquo;</p><p>The wizard will then ask you to select the layout of your keyboard (I have a French keyboard). Select the layout that suits you, then press &ldquo;Select&rdquo;.</p><p><img loading=lazy src=/images/pfsense/pfsense3.png alt=pfsense3></p><p>Confirm your choice.</p><p><img loading=lazy src=/images/pfsense/pfsense4.png alt=pfsense4></p><p>We are then asked how to partition our disk. Choose &ldquo;Auto (UFS) BIOS&rdquo;, then &ldquo;OK&rdquo;.</p><p><img loading=lazy src=/images/pfsense/pfsense5.png alt=pfsense5></p><p>Pfsense will then start its installation:</p><p><img loading=lazy src=/images/pfsense/pfsense6.png alt=pfsense6></p><p>If the wizard asks you to open a Shell, answer &ldquo;no.&rdquo;</p><p>You will restart the virtual machine when the wizard suggests it.</p><h2 id=pfsense-startup-configuration>Pfsense startup configuration<a hidden class=anchor aria-hidden=true href=#pfsense-startup-configuration>#</a></h2><p>On reboot, you will be asked if the VLANS should be configured. Press &ldquo;n&rdquo; then &ldquo;Enter&rdquo;.</p><p><img loading=lazy src=/images/pfsense/pfsense7.png alt=pfsense7></p><p>Then you have to tell Pfsense which interfaces correspond to the WAN and the LAN. For the moment, we don&rsquo;t know what &ldquo;em0&rdquo; and &ldquo;em1&rdquo; correspond to, so let&rsquo;s put them randomly (we can change this later).</p><p><img loading=lazy src=/images/pfsense/pfsense8.png alt=pfsense8></p><p>Then confirm by pressing &ldquo;y&rdquo;:</p><p><img loading=lazy src=/images/pfsense/pfsense9.png alt=pfsense9></p><p>And we have finally finished the installation of Pfsense! Now you should arrive on the main configuration menu.</p><p><img loading=lazy src=/images/pfsense/pfsense10.png alt=pfsense10></p><p>Don&rsquo;t panic if you don&rsquo;t have IP addresses for &ldquo;em1&rdquo; or &ldquo;em0&rdquo; (like me), we&rsquo;ll fix that right away!</p><p>Press the &ldquo;1&rdquo; key on the keyboard to assign the interfaces correctly.</p><p><img loading=lazy src=/images/pfsense/pfsense11.png alt=pfsense11></p><p>We then notice that next to &ldquo;em0&rdquo; and &ldquo;em1&rdquo;, there are MAC addresses&mldr;</p><p>The wizard (re)asks us if we want to configure the VLANS. Press &ldquo;n&rdquo;.</p><p>Then we are asked which interface corresponds to the WAN. But how do we know? &ldquo;em0&rdquo;? &ldquo;em1&rdquo;? A little explanation is necessary.</p><p>When we configured the interfaces of the Pfsense VM, we put one in &ldquo;LAN segment&rdquo; and another in &ldquo;Bridged&rdquo;. The &ldquo;LAN segment&rdquo; one corresponds to the LAN side of Pfsense, while the &ldquo;Bridged&rdquo; one corresponds to the WAN side.</p><p>But how do you know which one corresponds to &ldquo;em0&rdquo; or &ldquo;em1&rdquo;? With the MAC addresses you normally wrote down earlier! In my case, I know that the LAN interface has a MAC address that ends with :d9:f4; and that the WAN interface&rsquo;s MAC address ends with :6a:69.</p><p>It says right above which one corresponds to what.</p><p>So you can enter the interface that corresponds to the WAN side (in my case, &ldquo;em0&rdquo;):</p><p><img loading=lazy src=/images/pfsense/pfsense12.png alt=pfsense12></p><p>Do the same for the LAN interface:</p><p><img loading=lazy src=/images/pfsense/pfsense13.png alt=pfsense13></p><p>Press &ldquo;y&rdquo; to confirm the changes:</p><p><img loading=lazy src=/images/pfsense/pfsense14.png alt=pfsense14></p><p>Personally, I will change the IP address of my LAN interface, so I will choose option 2:</p><p><img loading=lazy src=/images/pfsense/pfsense15.png alt=pfsense15></p><p>I will give it the IP address 192.168.100.254, with a mask of /24. (I also specify that I don&rsquo;t want to use DHCP).</p><p>If you are offered to use HTTP for the WebConfigurator, press &ldquo;y&rdquo;.</p><p><img loading=lazy src=/images/pfsense/pfsense16.png alt=pfsense16></p><p>We will then proceed to the configuration of PC1!</p><p><strong><em>The next part of the tutorial is ➡️ <a href=/proxy/proxy3>here</a> ⬅️.</em></strong></p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://www.thomaswimart.fr/>WIMART Thomas</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>